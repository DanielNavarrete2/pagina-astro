---
import { Image } from 'astro:assets';
import Imagen1 from '../assets/hero1.jpg';
import Imagen2 from '../assets/hero2.webp';
import Imagen3 from '../assets/hero3.jpg';
import Imagen4 from '../assets/hero4.avif';

const images = [
  { src: Imagen1, alt: 'imagen de vinilos' },
  { src: Imagen2, alt: 'imagen de concierto' },
  { src: Imagen3, alt: 'imagen de guitarra' },
  { src: Imagen4, alt: 'imagen de música' },
];
---

<div class="w-full max-w-5xl mx-auto overflow-hidden rounded-lg shadow-xl mt-10 relative">
  <!-- Contenedor de imágenes -->
  <div class="h-[400px] w-full relative">
    <div id="carousel-container" class="flex transition-transform duration-500 ease-in-out h-full">
      {images.map((image) => (
        <Image 
          src={image.src} 
          alt={image.alt} 
          class="w-full h-full object-cover flex-shrink-0" 
          width={1200}
          height={400}
        />
      ))}
    </div>
  </div>

  <!-- Botones de navegación -->
  <button
    id="prev-btn"
    class="absolute left-4 top-1/2 -translate-y-1/2 bg-black/50 hover:bg-black/70 text-white p-3 rounded-full transition-colors"
    aria-label="Imagen anterior"
  >
    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7" />
    </svg>
  </button>

  <button
    id="next-btn"
    class="absolute right-4 top-1/2 -translate-y-1/2 bg-black/50 hover:bg-black/70 text-white p-3 rounded-full transition-colors"
    aria-label="Siguiente imagen"
  >
    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" />
    </svg>
  </button>

  <!-- Indicadores (dots) -->
  <div class="absolute bottom-4 left-1/2 -translate-x-1/2 flex gap-2">
    {images.map((_, index) => (
      <button
        class="dot w-3 h-3 rounded-full bg-white/50 hover:bg-white/80 transition-colors"
        data-index={index}
        aria-label={`Ir a imagen ${index + 1}`}
      />
    ))}
  </div>
</div>

<script>
  const container = document.getElementById('carousel-container');
  const prevBtn = document.getElementById('prev-btn');
  const nextBtn = document.getElementById('next-btn');
  const dots = document.querySelectorAll('.dot');
  
  let currentIndex = 0;
  const totalImages = dots.length;

  function updateCarousel() {
    if (container) {
      container.style.transform = `translateX(-${currentIndex * 100}%)`;
    }
    
    dots.forEach((dot, index) => {
      if (index === currentIndex) {
        dot.classList.add('bg-white');
        dot.classList.remove('bg-white/50');
      } else {
        dot.classList.remove('bg-white');
        dot.classList.add('bg-white/50');
      }
    });
  }

  prevBtn?.addEventListener('click', () => {
    currentIndex = (currentIndex - 1 + totalImages) % totalImages;
    updateCarousel();
  });

  nextBtn?.addEventListener('click', () => {
    currentIndex = (currentIndex + 1) % totalImages;
    updateCarousel();
  });

  dots.forEach((dot) => {
    dot.addEventListener('click', (e) => {
      const target = e.target as HTMLElement;
      currentIndex = parseInt(target.dataset.index || '0');
      updateCarousel();
    });
  });

  // Auto-play (opcional)
  setInterval(() => {
    currentIndex = (currentIndex + 1) % totalImages;
    updateCarousel();
  }, 5000); // Cambia cada 5 segundos

  updateCarousel();
</script>